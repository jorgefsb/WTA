<div class="box span12">
    <div class="box-header well" data-original-title>
        <h2>Product List</h2>
    </div>
    <div class="box-content">
        <form method="get" action="">
            <div class="span4">
                <h3>Filters</h3>
                <div class="well">

                    <h4>Date Range</h4>
                    <div class="control-group" style="text-align: left">
                        <label class="control-label" for="fromDate">From Date</label>
                        <div class="controls">
                            <input type="text" class="datepicker" value="<?php echo $this->fromDate; ?>" id="fromDate" name="fromDate" value="">
                        </div>
                    </div>
                    <div class="control-group" style="text-align: left">
                        <label class="control-label" for="toDate">To Date</label>
                        <div class="controls">
                            <input type="text" class="datepicker" value="<?php echo $this->toDate; ?>" id="toDate" name="toDate" value="">
                        </div>
                    </div>

                    <h4>User</h4>
                    <div class="control-group">
                        <label class="control-label" for="menbers">Select User</label>
                        <div class="controls">
                            <select id="menbers" name="menbers[]" multiple data-rel="chosen">
                                <?php foreach($this->userOrders as $index): ?>
                                <option value="<?php echo $index['member_id']?>" <?php echo in_array($index['member_id'],$this->menbers)?'selected':'' ?> ><?php echo $index['member_name'].' '.$index['member_last_name']?></option>
                                <?php endforeach; ?>
                            </select>
                        </div>
                    </div>
                    <h4>State</h4>
                    <div class="control-group" style="text-align: left">
                        <?php
                        $state = array(
                            Application_Entity_Transaction::TRANSACTION_OUTSTANDING => 'OUTSTANDING',
                            Application_Entity_Transaction::TRANSACTION_PAID => 'PAID',
                            Application_Entity_Transaction::TRANSACTION_REMOVED => 'REMOVED'
                        );
                        ?>
                        <?php foreach ($state as $index => $value): ?>
                            <label>
                                <input <?php echo in_array($index,$this->state)?'checked="checked"':'' ?> type="checkbox" id="state<?php echo $index; ?>" name="state[]" value="<?php echo $index; ?>" /><?php echo $value; ?>
                            </label>
                        <?php endforeach; ?>

                    </div>

                    <h4>Delivered</h4>
                    <div class="control-group" style="text-align: left">
                        <?php
                        $stateDelivered = array(
                            1 => 'Yes',
                            0 => 'No'
                        );
                        ?>
                        <?php foreach ($stateDelivered as $index => $value): ?>
                            <label><input <?php echo in_array($index,$this->stateDelivered)?'checked="checked"':'' ?> type="checkbox" id="stateDelivered<?php echo $index; ?>" name="stateDelivered[]" value="<?php echo $index; ?>" /><?php echo $value; ?></label>
                        <?php endforeach; ?>

                    </div>
                    <div style="text-align: right">
                        <a href="/admin/orders">Cancel Filter</a>
                        <input type="submit" value="Send" />
                    </div>
                </div>
            </div>

        </form> 
        <table class="table">
            <thead>
                <tr>
                    <th>
                        Registration Date
                    </th>
                    <th>
                        Customer
                    </th>
                    <th>
                        State
                    </th>
                    <th>
                        Product
                    </th>
                    <th>
                        Delivered
                    </th>
                    <th>
                        Delivered Date
                    </th>
                </tr>
            </thead>
            <?php foreach ($this->orders as $index): ?>
                <tr>
                    <td>
                        <?php echo $index['transaction_payment_date']; ?>
                    </td>
                    <td>
                        <?php echo $index['member_name']; ?> 
                        <?php echo $index['member_last_name']; ?>
                    </td>
                    <td>
                        <?php echo $index['tansaction_state_name']; ?>
                    </td>
                    <td>
                        <?php $arrayProducts = explode('[]', $index['product']);
                        ?>
                        <table class="table table-bordered table-striped table-condensed">
                            <thead>
                                <tr>
                                    <th>
                                        Name Product
                                    </th>
                                    <th>
                                        Quantity
                                    </th>
                                    <th>
                                        Guest Price
                                    </th>
                                    <th>
                                        Member Price
                                    </th>
                                </tr>
                            </thead>
                            <?php
                            foreach ($arrayProducts as $index2) {
                                $product = explode('|', $index2);
                                ?>
                                <tr>
                                    <td>
                                        <?php echo $product[0]; ?>
                                    </td>
                                    <td>
                                        <?php echo $product[1]; ?>
                                    </td>
                                    <?php if($index['transaction_user_menbership']==1){
                                        $price = $product[3];
                                        ?>
                                    <td style="text-decoration: line-through">
                                        <?php echo $product[2]; ?>
                                    </td>
                                    <td>
                                        <span class="label label-success"><?php echo $product[3]; ?></span>
                                    </td>
                                    <?php } else { $price = $product[2];?>
                                    <td>
                                        <span class="label label-success"><?php echo $product[2]; ?></span>
                                    </td>
                                    <td style="text-decoration: line-through" >
                                        <?php echo $product[3]; ?>
                                    </td>
                                    
                                    <?php } ?>
                                </tr>
                                
                                <?php
                                $priceTotal = $product[1]*$price;
                            }
                            ?>
                                <tr>
                                    <td colspan="2">
                                        
                                    </td>
                                    <td style="background-color: #DD5600; color: #ffffff" >
                                     Total   
                                    </td>
                                    <td style="background-color: #DD5600; color: #ffffff">
                                        <?php echo $priceTotal; ?>
                                    </td>
                                </tr>
                        </table>
                    </td>
                    <td>
                        <?php
                        $arrayEstatus = array('No', 'Yes');
                        echo $arrayEstatus[$index['transaction_delivered']];
                        ?> 
                    </td>
                    <td>
                        <?php
                        echo $index['transaction_delivered_date'];
                        ?> 
                    </td>
                </tr>
            <?php endforeach; ?>
        </table>
    </div>
</div>


